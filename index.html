<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Story Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #4a5568;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #718096;
            font-size: 1.1rem;
        }

        .setup-section {
            background: #fff5f5;
            border: 2px solid #feb2b2;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .setup-section h3 {
            color: #c53030;
            margin-bottom: 10px;
        }

        .setup-section p {
            color: #744444;
            margin-bottom: 15px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .hints-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            resize: vertical;
            min-height: 120px;
        }

        .hints-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .row {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }

        .col {
            flex: 1;
        }

        .age-input, .length-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .age-input:focus, .length-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .generate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .story-output {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 25px;
            min-height: 300px;
            font-size: 1.1rem;
            line-height: 1.8;
            color: #4a5568;
            white-space: pre-wrap;
            margin-bottom: 20px;
            display: none;
        }

        .story-output.show {
            display: block;
        }

        .loading {
            text-align: center;
            color: #667eea;
            font-style: italic;
            font-size: 1.1rem;
        }

        .copy-btn, .regenerate-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .regenerate-btn {
            background: #ed8936;
        }

        .copy-btn:hover {
            background: #38a169;
        }

        .regenerate-btn:hover {
            background: #dd6b20;
        }

        .example {
            background: #edf2f7;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #4a5568;
        }

        .example strong {
            color: #667eea;
        }

        .thinking-display {
            background: #f0fff4;
            border: 1px solid #9ae6b4;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #2d5016;
            display: none;
        }

        .thinking-display.show {
            display: block;
        }

        @media (max-width: 600px) {
            .row {
                flex-direction: column;
            }
            
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† AI Story Generator</h1>
            <p>Create unique stories from ANY characters, themes, or ideas!</p>
        </div>

        <div class="setup-section" id="setupSection">
            <h3>‚öôÔ∏è FREE Demo Mode</h3>
            <p>Click below to start generating unlimited FREE stories with our AI storyteller!</p>
            <button id="demoBtn" onclick="enableDemoMode()" style="background: #805ad5; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 1.1rem;">üé¨ Start FREE Demo Mode</button>
        </div>

        <div class="example">
            <strong>Try ANY characters or themes:</strong><br>
            ‚Ä¢ "Luna the dragon, magical forest, lost memories"<br>
            ‚Ä¢ "Robot named Zyx, underwater city, friendship"<br>
            ‚Ä¢ "Princess Aria, talking animals, environmental problem"<br>
            ‚Ä¢ "Space explorer cats, alien planet, teamwork"<br>
            ‚Ä¢ "Time-traveling librarian, ancient Egypt, mystery"
        </div>

        <div class="input-group">
            <label for="hints">Story Elements (Characters, Setting, Theme):</label>
            <textarea 
                id="hints" 
                class="hints-input" 
                placeholder="Enter ANY characters, settings, themes, or problems...

Examples:
- A brave little mouse named Pip, enchanted bakery, courage
- Twin robots, floating city, learning emotions  
- Magical paintbrush, artist girl, helping others
- Dancing elephant, circus, finding confidence
- Wise old turtle, ocean cleanup, responsibility"
            ></textarea>
        </div>

        <div class="row">
            <div class="col">
                <div class="input-group">
                    <label for="age">Child's Age:</label>
                    <input type="number" id="age" class="age-input" min="1" max="18" value="7" placeholder="Age">
                </div>
            </div>
            <div class="col">
                <div class="input-group">
                    <label for="storyFocus">Story Focus:</label>
                    <select id="storyFocus" class="length-select">
                        <option value="adventure">Adventure & Problem Solving</option>
                        <option value="friendship">Friendship & Social Skills</option>
                        <option value="learning">Learning & Education</option>
                        <option value="responsibility">Responsibility & Growing Up</option>
                        <option value="creativity">Creativity & Imagination</option>
                        <option value="courage">Courage & Overcoming Fears</option>
                    </select>
                </div>
            </div>
        </div>

        <button id="generateBtn" class="generate-btn" onclick="generateStory()">üß† Generate Unique Story</button>

        <div id="thinkingDisplay" class="thinking-display">
            <strong>ü§î AI Thinking Process:</strong>
            <div id="thinkingContent"></div>
        </div>

        <div id="storyOutput" class="story-output"></div>

        <div id="actionButtons" style="display: none;">
            <button id="copyBtn" class="copy-btn" onclick="copyStory()">üìã Copy Story</button>
            <button id="regenerateBtn" class="regenerate-btn" onclick="regenerateStory()">üîÑ Generate New Story</button>
        </div>
    </div>

    <script>
        let currentApiKey = 'demo';
        let currentStory = '';

        // AI Story Generation Engine
        class StoryAI {
            constructor() {
                this.storyTemplates = [
                    'hero-journey', 'problem-solution', 'friendship-adventure', 
                    'mystery-discovery', 'transformation', 'quest', 'rescue-mission'
                ];
                
                this.plotDevices = [
                    'unexpected ally', 'hidden talent', 'magical object', 'wise mentor',
                    'challenging obstacle', 'misunderstanding', 'lost item', 'secret revealed'
                ];
                
                this.settings = [
                    'enchanted forest', 'bustling city', 'peaceful village', 'mysterious cave',
                    'floating island', 'underwater kingdom', 'mountain peak', 'desert oasis',
                    'ancient library', 'space station', 'magical school', 'hidden garden'
                ];
                
                this.emotions = [
                    'excited', 'curious', 'nervous', 'determined', 'hopeful', 'worried', 'brave'
                ];
                
                this.conflicts = [
                    'must find something lost', 'needs to help someone', 'faces a big fear',
                    'solves a mystery', 'learns a new skill', 'makes a difficult choice',
                    'brings friends together', 'protects something precious'
                ];
                
                this.lessons = [
                    'friendship is powerful', 'everyone has unique talents', 'courage comes from within',
                    'helping others feels wonderful', 'mistakes help us learn', 'teamwork solves problems',
                    'being different is special', 'persistence pays off'
                ];
            }

            extractElements(input) {
                const words = input.toLowerCase().split(/[,\s]+/);
                const characters = [];
                const themes = [];
                const settings = [];
                
                // Simple keyword extraction (in a real AI this would be more sophisticated)
                words.forEach(word => {
                    if (word.length > 2) {
                        if (Math.random() > 0.7) themes.push(word);
                        if (Math.random() > 0.8) characters.push(word);
                    }
                });
                
                return { characters, themes, settings, originalInput: input };
            }

            generateTitle(elements, template) {
                const titleTypes = [
                    `${this.capitalize(elements.originalInput.split(',')[0])} and the ${this.getRandomElement(['Great', 'Amazing', 'Mysterious', 'Magical'])} ${this.getRandomElement(['Adventure', 'Quest', 'Journey', 'Challenge'])}`,
                    `The ${this.getRandomElement(['Tale', 'Story', 'Legend', 'Adventure'])} of ${this.getRandomElement(elements.originalInput.split(','))}`,
                    `When ${this.getRandomElement(['Magic', 'Friendship', 'Courage', 'Wonder'])} ${this.getRandomElement(['Happened', 'Bloomed', 'Awakened', 'Emerged'])}`,
                    `${this.getRandomElement(['A', 'The'])} ${this.getRandomElement(['Wonderful', 'Amazing', 'Incredible', 'Fantastic'])} ${this.getRandomElement(['Day', 'Adventure', 'Discovery', 'Journey'])}`
                ];
                
                return this.getRandomElement(titleTypes);
            }

            generateStory(input, age, focus) {
                const elements = this.extractElements(input);
                const template = this.getRandomElement(this.storyTemplates);
                const setting = this.getRandomElement(this.settings);
                const emotion = this.getRandomElement(this.emotions);
                const conflict = this.getRandomElement(this.conflicts);
                const plotDevice = this.getRandomElement(this.plotDevices);
                const lesson = this.getRandomElement(this.lessons);
                const timeOfDay = this.getRandomElement(['morning', 'afternoon', 'evening', 'dawn', 'sunset']);
                const weather = this.getRandomElement(['sunny', 'rainy', 'misty', 'cloudy', 'starry']);
                
                const title = this.generateTitle(elements, template);
                
                // Create unique story based on all elements
                const storyParts = this.buildStoryStructure(
                    input, setting, emotion, conflict, plotDevice, lesson, 
                    age, focus, timeOfDay, weather
                );
                
                const storyId = Math.floor(Math.random() * 999999);
                
                return {
                    title,
                    content: storyParts.join('\n\n'),
                    id: storyId
                };
            }

            buildStoryStructure(input, setting, emotion, conflict, plotDevice, lesson, age, focus, timeOfDay, weather) {
                // Extract main character/element from input
                const mainElement = input.split(',')[0].trim();
                const theme = input.includes(',') ? input.split(',')[1].trim() : 'adventure';
                
                const opening = this.generateOpening(mainElement, setting, timeOfDay, weather, emotion);
                const problem = this.generateProblem(mainElement, conflict, theme);
                const development = this.generateDevelopment(mainElement, plotDevice, focus);
                const climax = this.generateClimax(mainElement, theme, age);
                const resolution = this.generateResolution(mainElement, lesson, age);
                
                return [opening, problem, development, climax, resolution];
            }

            generateOpening(mainElement, setting, timeOfDay, weather, emotion) {
                const openings = [
                    `On a ${weather} ${timeOfDay}, ${mainElement} was feeling ${emotion} while exploring ${setting}.`,
                    `It was a ${weather} ${timeOfDay} when ${mainElement} discovered something amazing in ${setting}.`,
                    `${mainElement} had never seen ${setting} look so ${weather} during ${timeOfDay}, and felt ${emotion} about what the day might bring.`,
                    `The ${weather} ${timeOfDay} in ${setting} was perfect for an adventure, and ${mainElement} was ${emotion} to begin.`
                ];
                
                return this.getRandomElement(openings);
            }

            generateProblem(mainElement, conflict, theme) {
                const problems = [
                    `But soon, ${mainElement} discovered that they ${conflict}. This was connected to ${theme} in ways they hadn't expected.`,
                    `Everything changed when ${mainElement} realized they ${conflict}. The situation involved ${theme} and would require all their creativity.`,
                    `That's when ${mainElement} encountered a challenge: they ${conflict}. This problem was deeply connected to ${theme}.`,
                    `Suddenly, ${mainElement} found themselves in a situation where they ${conflict}. The theme of ${theme} became very important.`
                ];
                
                return this.getRandomElement(problems);
            }

            generateDevelopment(mainElement, plotDevice, focus) {
                const focusMap = {
                    'adventure': 'embarked on an exciting journey',
                    'friendship': 'reached out to friends for help',
                    'learning': 'studied and practiced new skills',
                    'responsibility': 'took charge of the situation',
                    'creativity': 'thought of innovative solutions',
                    'courage': 'faced their fears head-on'
                };
                
                const action = focusMap[focus] || 'tried different approaches';
                
                const developments = [
                    `${mainElement} ${action}, but then encountered ${plotDevice}. This changed everything and opened up new possibilities.`,
                    `At first, ${mainElement} ${action}. However, when ${plotDevice} appeared, they realized they needed to think differently.`,
                    `${mainElement} decided to ${action}. Along the way, ${plotDevice} taught them something important about themselves.`,
                    `Working hard, ${mainElement} ${action}. The discovery of ${plotDevice} helped them see the situation in a new light.`
                ];
                
                return this.getRandomElement(developments);
            }

            generateClimax(mainElement, theme, age) {
                const climaxes = age <= 8 ? [
                    `With determination and kindness, ${mainElement} found a way to solve the problem. The power of ${theme} helped them succeed.`,
                    `${mainElement} used their heart and creativity to make everything better. ${theme} proved to be the key to success.`,
                    `By being brave and caring, ${mainElement} was able to help everyone. ${theme} made all the difference.`,
                    `${mainElement} discovered that being true to themselves and focusing on ${theme} was the answer they needed.`
                ] : [
                    `Through perseverance and wisdom, ${mainElement} navigated the challenges. Their understanding of ${theme} became crucial to the solution.`,
                    `${mainElement} applied everything they had learned about ${theme} to overcome the obstacles. Their growth was evident in their approach.`,
                    `Drawing on inner strength and the lessons of ${theme}, ${mainElement} found a path forward that helped everyone involved.`,
                    `${mainElement} realized that ${theme} wasn't just about the immediate problem, but about becoming the person they were meant to be.`
                ];
                
                return this.getRandomElement(climaxes);
            }

            generateResolution(mainElement, lesson, age) {
                const resolutions = age <= 8 ? [
                    `In the end, ${mainElement} learned that ${lesson}. Everyone was happy, and they all celebrated their success together.`,
                    `${mainElement} felt proud of what they accomplished and understood that ${lesson}. It was a day they would never forget.`,
                    `The adventure taught ${mainElement} that ${lesson}. They went home with a big smile and a heart full of joy.`,
                    `${mainElement} discovered the most important thing of all: ${lesson}. From that day on, everything was brighter.`
                ] : [
                    `The experience transformed ${mainElement}'s understanding, teaching them that ${lesson}. This wisdom would guide them in future challenges.`,
                    `${mainElement} emerged from the adventure with a deeper appreciation for how ${lesson}. The lessons learned became part of who they were.`,
                    `Through this journey, ${mainElement} gained invaluable insight: ${lesson}. This knowledge would serve them well in all their future endeavors.`,
                    `${mainElement} concluded their adventure with a profound realization that ${lesson}. This understanding opened new possibilities for growth and connection.`
                ];
                
                return this.getRandomElement(resolutions);
            }

            getRandomElement(array) {
                return array[Math.floor(Math.random() * array.length)];
            }

            capitalize(str) {
                return str.charAt(0).toUpperCase() + str.slice(1);
            }
        }

        // Initialize AI
        const storyAI = new StoryAI();

        function enableDemoMode() {
            document.getElementById('setupSection').style.display = 'none';
            alert('üé¨ Demo mode activated! Generate unlimited FREE stories with any characters!');
        }

        async function generateStory() {
            const hints = document.getElementById('hints').value.trim();
            const age = parseInt(document.getElementById('age').value);
            const storyFocus = document.getElementById('storyFocus').value;

            if (!hints) {
                alert('Please enter some story elements (characters, themes, settings)!');
                return;
            }

            if (!currentApiKey) {
                enableDemoMode();
            }

            const generateBtn = document.getElementById('generateBtn');
            const storyOutput = document.getElementById('storyOutput');
            const thinkingDisplay = document.getElementById('thinkingDisplay');
            const thinkingContent = document.getElementById('thinkingContent');
            
            generateBtn.disabled = true;
            generateBtn.textContent = 'üß† AI Creating Story...';
            storyOutput.classList.add('show');
            storyOutput.innerHTML = '<div class="loading">‚ú® AI is crafting your unique story...</div>';
            thinkingDisplay.classList.add('show');

            try {
                // Simulate AI thinking process
                thinkingContent.innerHTML = `üîç Analyzing input: "${hints}"...`;
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                thinkingContent.innerHTML = 'üé≠ Creating unique characters and setting...';
                await new Promise(resolve => setTimeout(resolve, 1200));
                
                thinkingContent.innerHTML = 'üìù Building story structure and plot...';
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                thinkingContent.innerHTML = 'üé® Adding creative elements and emotions...';
                await new Promise(resolve => setTimeout(resolve, 800));
                
                thinkingContent.innerHTML = '‚ú® Finalizing your unique story...';
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Generate the actual story
                const story = storyAI.generateStory(hints, age, storyFocus);
                displayStory(`# ${story.title}\n\n${story.content}\n\n*Unique Story ID: ${story.id} - Generated by AI*`);
                
                thinkingDisplay.classList.remove('show');
            } catch (error) {
                storyOutput.innerHTML = `<div style="color: red;">Error: ${error.message}</div>`;
            }

            generateBtn.disabled = false;
            generateBtn.textContent = 'üß† Generate Unique Story';
        }

        function displayStory(story) {
            const storyOutput = document.getElementById('storyOutput');
            const actionButtons = document.getElementById('actionButtons');
            
            currentStory = story;
            storyOutput.innerHTML = story;
            actionButtons.style.display = 'block';
        }

        function copyStory() {
            navigator.clipboard.writeText(currentStory).then(() => {
                const copyBtn = document.getElementById('copyBtn');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '‚úÖ Copied!';
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 2000);
            }).catch(() => {
                alert('Unable to copy story. Please select and copy manually.');
            });
        }

        function regenerateStory() {
            generateStory();
        }
    </script>
</body>
</html>
